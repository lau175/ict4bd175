{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import dec\n",
    "from epw import epw\n",
    "#from pyepw.epw import EPW\n",
    "#epw = EPW()\n",
    "import numpy as np\n",
    "import datetime"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date_Time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:20:00</th>\n",
       "      <td>1.111111</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>75</td>\n",
       "      <td>22.5</td>\n",
       "      <td>6.705409</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:50:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80</td>\n",
       "      <td>22.5</td>\n",
       "      <td>5.811354</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:20:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>87</td>\n",
       "      <td>22.5</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:50:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80</td>\n",
       "      <td>337.5</td>\n",
       "      <td>3.129191</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:20:00</th>\n",
       "      <td>1.111111</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>75</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:50:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61</td>\n",
       "      <td>315.0</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:20:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61</td>\n",
       "      <td>315.0</td>\n",
       "      <td>3.129191</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:50:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65</td>\n",
       "      <td>337.5</td>\n",
       "      <td>4.470273</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:20:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65</td>\n",
       "      <td>337.5</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:50:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17465 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity   Wind  Speed_m/s  \\\n",
       "Date_Time                                                                     \n",
       "2016-01-01 00:20:00       1.111111    -2.777778        75   22.5   6.705409   \n",
       "2016-01-01 00:50:00       0.000000    -2.777778        80   22.5   5.811354   \n",
       "2016-01-01 01:20:00       0.000000    -2.222222        87   22.5   5.364327   \n",
       "2016-01-01 01:50:00       0.000000    -2.777778        80  337.5   3.129191   \n",
       "2016-01-01 02:20:00       1.111111    -2.777778        75    0.0   5.364327   \n",
       "...                            ...          ...       ...    ...        ...   \n",
       "2016-12-31 21:50:00       3.888889    -2.777778        61  315.0   5.364327   \n",
       "2016-12-31 22:20:00       3.888889    -2.777778        61  315.0   3.129191   \n",
       "2016-12-31 22:50:00       3.888889    -2.222222        65  337.5   4.470273   \n",
       "2016-12-31 23:20:00       3.888889    -2.222222        65  337.5   3.576218   \n",
       "2016-12-31 23:50:00       3.888889    -2.222222        65    0.0   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "Date_Time                                                   \n",
       "2016-01-01 00:20:00       0.0    101749.30               0  \n",
       "2016-01-01 00:50:00       0.0    101749.30               0  \n",
       "2016-01-01 01:20:00       0.0    101749.30               0  \n",
       "2016-01-01 01:50:00       0.0    101647.72               0  \n",
       "2016-01-01 02:20:00       0.0    101647.72               0  \n",
       "...                       ...          ...             ...  \n",
       "2016-12-31 21:50:00       0.0    101342.98               0  \n",
       "2016-12-31 22:20:00       0.0    101342.98               0  \n",
       "2016-12-31 22:50:00       0.0    101342.98               0  \n",
       "2016-12-31 23:20:00       0.0    101342.98               0  \n",
       "2016-12-31 23:50:00       0.0    101342.98               0  \n",
       "\n",
       "[17465 rows x 8 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "meteo_df=pd.read_csv('LGAV_from_2016-01-01_to_2016-12-31.csv',index_col='Date_Time',parse_dates=[0,])\n",
    "meteo_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date_Time</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>22.50</td>\n",
       "      <td>6.258382</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>83.5</td>\n",
       "      <td>180.00</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>81.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "Date_Time                                                                      \n",
       "2016-01-01 00:00:00       0.555556    -2.777778      77.5   22.50   6.258382   \n",
       "2016-01-01 01:00:00       0.000000    -2.500000      83.5  180.00   4.246759   \n",
       "2016-01-01 02:00:00       0.555556    -2.500000      81.0    0.00   4.917300   \n",
       "2016-01-01 03:00:00       0.555556    -2.777778      77.5  168.75   4.917300   \n",
       "2016-01-01 04:00:00       0.000000    -2.777778      80.0    0.00   4.917300   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "Date_Time                                                   \n",
       "2016-01-01 00:00:00       0.0    101749.30             0.0  \n",
       "2016-01-01 01:00:00       0.0    101698.51             0.0  \n",
       "2016-01-01 02:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 03:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 04:00:00       0.0    101647.72             0.0  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "meteo=meteo_df.resample('H').mean().interpolate()\n",
    "meteo.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#meteo=meteo.drop(columns=['Solar_W/m2', 'UV'])\n",
    "#meteo.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8784 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Temperature_C Dew_Point_C Humidity Wind Speed_m/s  \\\n",
       "2016-01-01 00:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-01-01 01:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-01-01 02:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-01-01 03:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-01-01 04:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "...                           ...         ...      ...  ...       ...   \n",
       "2016-12-31 19:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-12-31 20:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-12-31 21:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-12-31 22:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "2016-12-31 23:00:00           NaN         NaN      NaN  NaN       NaN   \n",
       "\n",
       "                    Gust_m/s Pressure_Pa Precip_Rate_mm  \n",
       "2016-01-01 00:00:00      NaN         NaN            NaN  \n",
       "2016-01-01 01:00:00      NaN         NaN            NaN  \n",
       "2016-01-01 02:00:00      NaN         NaN            NaN  \n",
       "2016-01-01 03:00:00      NaN         NaN            NaN  \n",
       "2016-01-01 04:00:00      NaN         NaN            NaN  \n",
       "...                      ...         ...            ...  \n",
       "2016-12-31 19:00:00      NaN         NaN            NaN  \n",
       "2016-12-31 20:00:00      NaN         NaN            NaN  \n",
       "2016-12-31 21:00:00      NaN         NaN            NaN  \n",
       "2016-12-31 22:00:00      NaN         NaN            NaN  \n",
       "2016-12-31 23:00:00      NaN         NaN            NaN  \n",
       "\n",
       "[8784 rows x 8 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "time_vector = pd.date_range(start='1/1/2016', end='01/01/2017', freq='H')\n",
    "newdf = pd.DataFrame(index=time_vector, columns=meteo.columns)\n",
    "newdf.drop(newdf.tail(1).index,inplace=True) # drop last 1 rows\n",
    "newdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>22.50</td>\n",
       "      <td>6.258382</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>83.5</td>\n",
       "      <td>180.00</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>81.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>157.50</td>\n",
       "      <td>3.352705</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>63.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>3.799732</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8784 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "2016-01-01 00:00:00       0.555556    -2.777778      77.5   22.50   6.258382   \n",
       "2016-01-01 01:00:00       0.000000    -2.500000      83.5  180.00   4.246759   \n",
       "2016-01-01 02:00:00       0.555556    -2.500000      81.0    0.00   4.917300   \n",
       "2016-01-01 03:00:00       0.555556    -2.777778      77.5  168.75   4.917300   \n",
       "2016-01-01 04:00:00       0.000000    -2.777778      80.0    0.00   4.917300   \n",
       "...                            ...          ...       ...     ...        ...   \n",
       "2016-12-31 19:00:00       4.444444    -2.777778      59.0  157.50   3.352705   \n",
       "2016-12-31 20:00:00       4.444444    -2.777778      59.0  168.75   4.246759   \n",
       "2016-12-31 21:00:00       3.888889    -2.777778      61.0  326.25   5.364327   \n",
       "2016-12-31 22:00:00       3.888889    -2.500000      63.0  326.25   3.799732   \n",
       "2016-12-31 23:00:00       3.888889    -2.222222      65.0  168.75   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "2016-01-01 00:00:00       0.0    101749.30             0.0  \n",
       "2016-01-01 01:00:00       0.0    101698.51             0.0  \n",
       "2016-01-01 02:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 03:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 04:00:00       0.0    101647.72             0.0  \n",
       "...                       ...          ...             ...  \n",
       "2016-12-31 19:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 20:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 21:00:00       0.0    101393.77             0.0  \n",
       "2016-12-31 22:00:00       0.0    101342.98             0.0  \n",
       "2016-12-31 23:00:00       0.0    101342.98             0.0  \n",
       "\n",
       "[8784 rows x 8 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "newdf.loc[meteo.index, meteo.columns] = meteo.loc[meteo.index, meteo.columns]\n",
    "newdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>22.50</td>\n",
       "      <td>6.258382</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>83.5</td>\n",
       "      <td>180.00</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>81.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>157.50</td>\n",
       "      <td>3.352705</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>63.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>3.799732</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8784 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "2016-01-01 00:00:00       0.555556    -2.777778      77.5   22.50   6.258382   \n",
       "2016-01-01 01:00:00       0.000000    -2.500000      83.5  180.00   4.246759   \n",
       "2016-01-01 02:00:00       0.555556    -2.500000      81.0    0.00   4.917300   \n",
       "2016-01-01 03:00:00       0.555556    -2.777778      77.5  168.75   4.917300   \n",
       "2016-01-01 04:00:00       0.000000    -2.777778      80.0    0.00   4.917300   \n",
       "...                            ...          ...       ...     ...        ...   \n",
       "2016-12-31 19:00:00       4.444444    -2.777778      59.0  157.50   3.352705   \n",
       "2016-12-31 20:00:00       4.444444    -2.777778      59.0  168.75   4.246759   \n",
       "2016-12-31 21:00:00       3.888889    -2.777778      61.0  326.25   5.364327   \n",
       "2016-12-31 22:00:00       3.888889    -2.500000      63.0  326.25   3.799732   \n",
       "2016-12-31 23:00:00       3.888889    -2.222222      65.0  168.75   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "2016-01-01 00:00:00       0.0    101749.30             0.0  \n",
       "2016-01-01 01:00:00       0.0    101698.51             0.0  \n",
       "2016-01-01 02:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 03:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 04:00:00       0.0    101647.72             0.0  \n",
       "...                       ...          ...             ...  \n",
       "2016-12-31 19:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 20:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 21:00:00       0.0    101393.77             0.0  \n",
       "2016-12-31 22:00:00       0.0    101342.98             0.0  \n",
       "2016-12-31 23:00:00       0.0    101342.98             0.0  \n",
       "\n",
       "[8784 rows x 8 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import time\n",
    "from datetime import timedelta\n",
    "\n",
    "df0 = newdf.copy()\n",
    "mask = newdf.isna()\n",
    "missing_values_time = df0[\"Temperature_C\"][mask[\"Temperature_C\"]].index\n",
    "\n",
    "while df0[\"Temperature_C\"].isna().any():\n",
    "    try:\n",
    "        df0.loc[missing_values_time] = df0.loc[missing_values_time - timedelta(days=1)].values\n",
    "    except:\n",
    "        df0.loc[missing_values_time] = -100000555555\n",
    "\n",
    "df0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>22.50</td>\n",
       "      <td>6.258382</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>83.5</td>\n",
       "      <td>180.00</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>81.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>157.50</td>\n",
       "      <td>3.352705</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>63.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>3.799732</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8784 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "2016-01-01 00:00:00       0.555556    -2.777778      77.5   22.50   6.258382   \n",
       "2016-01-01 01:00:00       0.000000    -2.500000      83.5  180.00   4.246759   \n",
       "2016-01-01 02:00:00       0.555556    -2.500000      81.0    0.00   4.917300   \n",
       "2016-01-01 03:00:00       0.555556    -2.777778      77.5  168.75   4.917300   \n",
       "2016-01-01 04:00:00       0.000000    -2.777778      80.0    0.00   4.917300   \n",
       "...                            ...          ...       ...     ...        ...   \n",
       "2016-12-31 19:00:00       4.444444    -2.777778      59.0  157.50   3.352705   \n",
       "2016-12-31 20:00:00       4.444444    -2.777778      59.0  168.75   4.246759   \n",
       "2016-12-31 21:00:00       3.888889    -2.777778      61.0  326.25   5.364327   \n",
       "2016-12-31 22:00:00       3.888889    -2.500000      63.0  326.25   3.799732   \n",
       "2016-12-31 23:00:00       3.888889    -2.222222      65.0  168.75   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "2016-01-01 00:00:00       0.0    101749.30             0.0  \n",
       "2016-01-01 01:00:00       0.0    101698.51             0.0  \n",
       "2016-01-01 02:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 03:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 04:00:00       0.0    101647.72             0.0  \n",
       "...                       ...          ...             ...  \n",
       "2016-12-31 19:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 20:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 21:00:00       0.0    101393.77             0.0  \n",
       "2016-12-31 22:00:00       0.0    101342.98             0.0  \n",
       "2016-12-31 23:00:00       0.0    101342.98             0.0  \n",
       "\n",
       "[8784 rows x 8 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df0= df0.replace(-100000555555, np.nan)\n",
    "df0.to_csv(\"meteo_2016\")\n",
    "df0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>22.50</td>\n",
       "      <td>6.258382</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>83.5</td>\n",
       "      <td>180.00</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>81.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.555556</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>77.5</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.917300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>157.50</td>\n",
       "      <td>3.352705</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>63.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>3.799732</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8784 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "2016-01-01 00:00:00       0.555556    -2.777778      77.5   22.50   6.258382   \n",
       "2016-01-01 01:00:00       0.000000    -2.500000      83.5  180.00   4.246759   \n",
       "2016-01-01 02:00:00       0.555556    -2.500000      81.0    0.00   4.917300   \n",
       "2016-01-01 03:00:00       0.555556    -2.777778      77.5  168.75   4.917300   \n",
       "2016-01-01 04:00:00       0.000000    -2.777778      80.0    0.00   4.917300   \n",
       "...                            ...          ...       ...     ...        ...   \n",
       "2016-12-31 19:00:00       4.444444    -2.777778      59.0  157.50   3.352705   \n",
       "2016-12-31 20:00:00       4.444444    -2.777778      59.0  168.75   4.246759   \n",
       "2016-12-31 21:00:00       3.888889    -2.777778      61.0  326.25   5.364327   \n",
       "2016-12-31 22:00:00       3.888889    -2.500000      63.0  326.25   3.799732   \n",
       "2016-12-31 23:00:00       3.888889    -2.222222      65.0  168.75   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm  \n",
       "2016-01-01 00:00:00       0.0    101749.30             0.0  \n",
       "2016-01-01 01:00:00       0.0    101698.51             0.0  \n",
       "2016-01-01 02:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 03:00:00       0.0    101647.72             0.0  \n",
       "2016-01-01 04:00:00       0.0    101647.72             0.0  \n",
       "...                       ...          ...             ...  \n",
       "2016-12-31 19:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 20:00:00       0.0    101444.56             0.0  \n",
       "2016-12-31 21:00:00       0.0    101393.77             0.0  \n",
       "2016-12-31 22:00:00       0.0    101342.98             0.0  \n",
       "2016-12-31 23:00:00       0.0    101342.98             0.0  \n",
       "\n",
       "[8784 rows x 8 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = df0.copy()\n",
    "mask = df.isna()\n",
    "missing_values_time = df[\"Temperature_C\"][mask[\"Temperature_C\"]].index\n",
    "\n",
    "while df[\"Temperature_C\"].isna().any():\n",
    "    try:\n",
    "        df.loc[missing_values_time] = df.loc[missing_values_time + timedelta(days=1)].values\n",
    "    except:\n",
    "        break\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Temperature_C', 'Dew_Point_C', 'Humidity', 'Wind', 'Speed_m/s',\n",
       "       'Gust_m/s', 'Pressure_Pa', 'Precip_Rate_mm'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.to_csv('meteo_2016_updated')\n",
    "meteo.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "latitude = 37.97 # latitude  N\n",
    "longitude = 23.92  # longitude E\n",
    "elevation = 131.064  # meters above the sea"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>time</th>\n",
       "      <th>G(i)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>20160101:0009</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>20160101:0109</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>20160101:0209</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>20160101:0309</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20160101:0409</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>20161231:1909</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>20161231:2009</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>20161231:2109</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>20161231:2209</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>20161231:2309</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               time G(i)\n",
       "0     20160101:0009    0\n",
       "1     20160101:0109    0\n",
       "2     20160101:0209    0\n",
       "3     20160101:0309    0\n",
       "4     20160101:0409    0\n",
       "...             ...  ...\n",
       "8755  20161231:1909    0\n",
       "8756  20161231:2009    0\n",
       "8757  20161231:2109    0\n",
       "8758  20161231:2209    0\n",
       "8759  20161231:2309    0\n",
       "\n",
       "[8760 rows x 2 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ghi_tot=pd.read_csv('ghi_2016_tot.csv')\n",
    "ghi_tot['G(i)']\n",
    "#to avoid saving possible blank lines at the end\n",
    "ghi_tot=ghi_tot[:8760].copy()\n",
    "ghi_tot=ghi_tot.drop(columns=['H_sun', 'T2m','WS10m','Int'])\n",
    "ghi_tot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "8784\n",
      "8760\n"
     ]
    }
   ],
   "source": [
    "#check for difference (leap year)\n",
    "print(len(df))\n",
    "print(len(ghi_tot))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "8760\n"
     ]
    }
   ],
   "source": [
    "#if leap year, run following code\n",
    "start=datetime.datetime.strptime('2016-02-28 23:59:59', '%Y-%m-%d %H:%M:%S')\n",
    "end=datetime.datetime.strptime('2016-02-29 23:59:59', '%Y-%m-%d %H:%M:%S')\n",
    "df_365=df[(df.index<start) | (df.index>end)]\n",
    "df=df_365.copy()\n",
    "print(len(df))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "df['G(i)']=ghi_tot['G(i)'].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['time', 'Gb(i)', 'Gd(i)', 'Gr(i)', 'H_sun', 'T2m', 'WS10m', 'Int'], dtype='object')"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ghi_comp0=pd.read_csv('ghi_2016_comp.csv')\n",
    "ghi_comp=ghi_comp0[:8760].copy()\n",
    "ghi_comp.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Temperature_C</th>\n",
       "      <th>Dew_Point_C</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Wind</th>\n",
       "      <th>Speed_m/s</th>\n",
       "      <th>Gust_m/s</th>\n",
       "      <th>Pressure_Pa</th>\n",
       "      <th>Precip_Rate_mm</th>\n",
       "      <th>G(i)</th>\n",
       "      <th>Gb(i)</th>\n",
       "      <th>Gd(i)</th>\n",
       "      <th>Gr(i)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-12-31 14:00:00</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>-3.888889</td>\n",
       "      <td>53.0</td>\n",
       "      <td>303.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101241.40</td>\n",
       "      <td>0.0</td>\n",
       "      <td>66</td>\n",
       "      <td>5.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 15:00:00</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>-3.888889</td>\n",
       "      <td>53.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>4.023245</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 16:00:00</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>-3.333333</td>\n",
       "      <td>55.0</td>\n",
       "      <td>315.00</td>\n",
       "      <td>3.129191</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 17:00:00</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>57.0</td>\n",
       "      <td>315.00</td>\n",
       "      <td>2.458650</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 18:00:00</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>57.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.693786</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>157.50</td>\n",
       "      <td>3.352705</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>4.444444</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>59.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>4.246759</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.777778</td>\n",
       "      <td>61.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>5.364327</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.500000</td>\n",
       "      <td>63.0</td>\n",
       "      <td>326.25</td>\n",
       "      <td>3.799732</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>3.888889</td>\n",
       "      <td>-2.222222</td>\n",
       "      <td>65.0</td>\n",
       "      <td>168.75</td>\n",
       "      <td>3.576218</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Temperature_C  Dew_Point_C  Humidity    Wind  Speed_m/s  \\\n",
       "2016-12-31 14:00:00       5.000000    -3.888889      53.0  303.75   3.576218   \n",
       "2016-12-31 15:00:00       5.000000    -3.888889      53.0  326.25   4.023245   \n",
       "2016-12-31 16:00:00       5.000000    -3.333333      55.0  315.00   3.129191   \n",
       "2016-12-31 17:00:00       5.000000    -2.777778      57.0  315.00   2.458650   \n",
       "2016-12-31 18:00:00       5.000000    -2.777778      57.0  168.75   4.693786   \n",
       "2016-12-31 19:00:00       4.444444    -2.777778      59.0  157.50   3.352705   \n",
       "2016-12-31 20:00:00       4.444444    -2.777778      59.0  168.75   4.246759   \n",
       "2016-12-31 21:00:00       3.888889    -2.777778      61.0  326.25   5.364327   \n",
       "2016-12-31 22:00:00       3.888889    -2.500000      63.0  326.25   3.799732   \n",
       "2016-12-31 23:00:00       3.888889    -2.222222      65.0  168.75   3.576218   \n",
       "\n",
       "                     Gust_m/s  Pressure_Pa  Precip_Rate_mm G(i)  Gb(i)  Gd(i)  \\\n",
       "2016-12-31 14:00:00       0.0    101241.40             0.0   66    5.0   61.0   \n",
       "2016-12-31 15:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "2016-12-31 16:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "2016-12-31 17:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "2016-12-31 18:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "2016-12-31 19:00:00       0.0    101444.56             0.0    0    0.0    0.0   \n",
       "2016-12-31 20:00:00       0.0    101444.56             0.0    0    0.0    0.0   \n",
       "2016-12-31 21:00:00       0.0    101393.77             0.0    0    0.0    0.0   \n",
       "2016-12-31 22:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "2016-12-31 23:00:00       0.0    101342.98             0.0    0    0.0    0.0   \n",
       "\n",
       "                     Gr(i)  \n",
       "2016-12-31 14:00:00      0  \n",
       "2016-12-31 15:00:00      0  \n",
       "2016-12-31 16:00:00      0  \n",
       "2016-12-31 17:00:00      0  \n",
       "2016-12-31 18:00:00      0  \n",
       "2016-12-31 19:00:00      0  \n",
       "2016-12-31 20:00:00      0  \n",
       "2016-12-31 21:00:00      0  \n",
       "2016-12-31 22:00:00      0  \n",
       "2016-12-31 23:00:00      0  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Gb(i)']=ghi_comp['Gb(i)'].values[:len(df)]\n",
    "df['Gd(i)']=ghi_comp['Gd(i)'].values[:len(df)]\n",
    "df['Gr(i)']=ghi_comp['Gr(i)'].values[:len(df)]\n",
    "df[-10:]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ghi</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-12-31 14:00:00</th>\n",
       "      <td>66.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 15:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 16:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 17:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 18:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      ghi\n",
       "2016-12-31 14:00:00  66.0\n",
       "2016-12-31 15:00:00   0.0\n",
       "2016-12-31 16:00:00   0.0\n",
       "2016-12-31 17:00:00   0.0\n",
       "2016-12-31 18:00:00   0.0\n",
       "2016-12-31 19:00:00   0.0\n",
       "2016-12-31 20:00:00   0.0\n",
       "2016-12-31 21:00:00   0.0\n",
       "2016-12-31 22:00:00   0.0\n",
       "2016-12-31 23:00:00   0.0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rad=pd.DataFrame(df['G(i)'].values,index=df.index,columns=['ghi'])\n",
    "rad=rad.astype('float64')\n",
    "rad[-10:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/ict4bd/shared/dec.py:244: RuntimeWarning: invalid value encountered in double_scalars\n",
      "  df['k_b'] = df['dni']/df['dni_clear']\n",
      "/home/ict4bd/shared/dec.py:245: RuntimeWarning: invalid value encountered in double_scalars\n",
      "  df['k_d'] = df['dhi']/df['dhi_clear']\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ghi</th>\n",
       "      <th>azimuth</th>\n",
       "      <th>zenith</th>\n",
       "      <th>altitude</th>\n",
       "      <th>AST</th>\n",
       "      <th>G_0</th>\n",
       "      <th>k_d</th>\n",
       "      <th>dhi</th>\n",
       "      <th>dni</th>\n",
       "      <th>k_b</th>\n",
       "      <th>G_1</th>\n",
       "      <th>doy</th>\n",
       "      <th>airmass_relative</th>\n",
       "      <th>m</th>\n",
       "      <th>k_t</th>\n",
       "      <th>dni_clear</th>\n",
       "      <th>dhi_clear</th>\n",
       "      <th>G_c</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-01-01 00:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-120.339792</td>\n",
       "      <td>155.219628</td>\n",
       "      <td>-65.219628</td>\n",
       "      <td>1.543270</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 01:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-103.502166</td>\n",
       "      <td>144.234277</td>\n",
       "      <td>-54.234277</td>\n",
       "      <td>2.542940</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 02:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-92.402199</td>\n",
       "      <td>132.535928</td>\n",
       "      <td>-42.535928</td>\n",
       "      <td>3.542610</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 03:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-83.464856</td>\n",
       "      <td>120.733863</td>\n",
       "      <td>-30.733863</td>\n",
       "      <td>4.542280</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-01-01 04:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-75.227583</td>\n",
       "      <td>109.125736</td>\n",
       "      <td>-19.125736</td>\n",
       "      <td>5.541950</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 19:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>93.243988</td>\n",
       "      <td>133.482223</td>\n",
       "      <td>-43.482223</td>\n",
       "      <td>20.538967</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 20:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>104.650728</td>\n",
       "      <td>145.147649</td>\n",
       "      <td>-55.147649</td>\n",
       "      <td>21.538639</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 21:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>122.290870</td>\n",
       "      <td>156.011370</td>\n",
       "      <td>-66.011370</td>\n",
       "      <td>22.538311</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 22:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>156.387929</td>\n",
       "      <td>163.901988</td>\n",
       "      <td>-73.901988</td>\n",
       "      <td>23.537982</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-12-31 23:00:00</th>\n",
       "      <td>0.0</td>\n",
       "      <td>-152.929430</td>\n",
       "      <td>163.516041</td>\n",
       "      <td>-73.516041</td>\n",
       "      <td>0.537654</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     ghi     azimuth      zenith   altitude        AST  G_0  \\\n",
       "2016-01-01 00:00:00  0.0 -120.339792  155.219628 -65.219628   1.543270  0.0   \n",
       "2016-01-01 01:00:00  0.0 -103.502166  144.234277 -54.234277   2.542940  0.0   \n",
       "2016-01-01 02:00:00  0.0  -92.402199  132.535928 -42.535928   3.542610  0.0   \n",
       "2016-01-01 03:00:00  0.0  -83.464856  120.733863 -30.733863   4.542280  0.0   \n",
       "2016-01-01 04:00:00  0.0  -75.227583  109.125736 -19.125736   5.541950  0.0   \n",
       "...                  ...         ...         ...        ...        ...  ...   \n",
       "2016-12-31 19:00:00  0.0   93.243988  133.482223 -43.482223  20.538967  0.0   \n",
       "2016-12-31 20:00:00  0.0  104.650728  145.147649 -55.147649  21.538639  0.0   \n",
       "2016-12-31 21:00:00  0.0  122.290870  156.011370 -66.011370  22.538311  0.0   \n",
       "2016-12-31 22:00:00  0.0  156.387929  163.901988 -73.901988  23.537982  0.0   \n",
       "2016-12-31 23:00:00  0.0 -152.929430  163.516041 -73.516041   0.537654  0.0   \n",
       "\n",
       "                     k_d  dhi  dni  k_b  G_1    doy  airmass_relative   m  \\\n",
       "2016-01-01 00:00:00  NaN  0.0  0.0  NaN  0.0    1.0               NaN NaN   \n",
       "2016-01-01 01:00:00  NaN  0.0  0.0  NaN  0.0    1.0               NaN NaN   \n",
       "2016-01-01 02:00:00  NaN  0.0  0.0  NaN  0.0    1.0               NaN NaN   \n",
       "2016-01-01 03:00:00  NaN  0.0  0.0  NaN  0.0    1.0               NaN NaN   \n",
       "2016-01-01 04:00:00  NaN  0.0  0.0  NaN  0.0    1.0               NaN NaN   \n",
       "...                  ...  ...  ...  ...  ...    ...               ...  ..   \n",
       "2016-12-31 19:00:00  NaN  0.0  0.0  NaN  0.0  366.0               NaN NaN   \n",
       "2016-12-31 20:00:00  NaN  0.0  0.0  NaN  0.0  366.0               NaN NaN   \n",
       "2016-12-31 21:00:00  NaN  0.0  0.0  NaN  0.0  366.0               NaN NaN   \n",
       "2016-12-31 22:00:00  NaN  0.0  0.0  NaN  0.0  366.0               NaN NaN   \n",
       "2016-12-31 23:00:00  NaN  0.0  0.0  NaN  0.0  366.0               NaN NaN   \n",
       "\n",
       "                     k_t  dni_clear  dhi_clear  G_c  \n",
       "2016-01-01 00:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-01-01 01:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-01-01 02:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-01-01 03:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-01-01 04:00:00  0.0        0.0        0.0  0.0  \n",
       "...                  ...        ...        ...  ...  \n",
       "2016-12-31 19:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-12-31 20:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-12-31 21:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-12-31 22:00:00  0.0        0.0        0.0  0.0  \n",
       "2016-12-31 23:00:00  0.0        0.0        0.0  0.0  \n",
       "\n",
       "[8760 rows x 18 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rad=dec.main(rad,latitude,longitude,elevation)\n",
    "rad"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'LOCATION': ['ATHENS', '-', 'GRC', 'IWEC Data', '167160', '37.90', '23.73', '2.0', '15.0'], 'DESIGN CONDITIONS': ['1', 'Climate Design Data 2009 ASHRAE Handbook', '', 'Heating', '2', '1.6', '3.1', '-6.8', '2.1', '5.1', '-4.9', '2.5', '5.7', '12.1', '9.7', '10.8', '8.9', '3.5', '0', 'Cooling', '8', '9.1', '35.1', '21.1', '33.8', '20.8', '32.4', '20.9', '24.4', '31', '23.6', '30.1', '22.8', '29.2', '5.6', '30', '22.2', '16.9', '28.7', '21.2', '15.9', '28', '20.5', '15.2', '27.5', '73.9', '31.4', '70.5', '30.2', '67.5', '29.3', '1110', 'Extremes', '10', '9', '8.2', '29', '-0.4', '38', '1.7', '1.9', '-1.7', '39.3', '-2.7', '40.4', '-3.7', '41.5', '-4.9', '42.8'], 'TYPICAL/EXTREME PERIODS': ['6', 'Summer - Week Nearest Max Temperature For Period', 'Extreme', '8/ 3', '8/ 9', 'Summer - Week Nearest Average Temperature For Period', 'Typical', '6/29', '7/ 5', 'Winter - Week Nearest Min Temperature For Period', 'Extreme', '2/17', '2/23', 'Winter - Week Nearest Average Temperature For Period', 'Typical', '1/13', '1/19', 'Autumn - Week Nearest Average Temperature For Period', 'Typical', '10/13', '10/19', 'Spring - Week Nearest Average Temperature For Period', 'Typical', '4/ 5', '4/11'], 'GROUND TEMPERATURES': ['3', '.5', '', '', '', '9.73', '11.26', '14.24', '17.06', '22.41', '25.22', '25.99', '24.57', '21.27', '17.17', '13.13', '10.46', '2', '', '', '', '11.84', '12.22', '13.91', '15.81', '19.91', '22.54', '23.84', '23.55', '21.67', '18.84', '15.65', '13.14', '4', '', '', '', '14.02', '13.76', '14.50', '15.58', '18.29', '20.32', '21.64', '21.96', '21.14', '19.47', '17.31', '15.35'], 'HOLIDAYS/DAYLIGHT SAVINGS': ['No', '0', '0', '0'], 'COMMENTS 1': [\"IWEC- WMO#167160 - Europe -- Original Source Data (c) 2001 American Society of Heating, Refrigerating and Air-Conditioning Engineers (ASHRAE), Inc., Atlanta, GA, USA.  www.ashrae.org  All rights reserved as noted in the License Agreement and Additional Conditions. DISCLAIMER OF WARRANTIES: The data is provided 'as is' without warranty of any kind, either expressed or implied. The entire risk as to the quality and performance of the data is with you. In no event will ASHRAE or its contractors be liable to you for any damages, including without limitation any lost profits, lost savings, or other incidental or consequential damages arising out of the use or inability to use this data.\"], 'COMMENTS 2': [' -- Ground temps produced with a standard soil diffusivity of 2.3225760E-03 {m**2/day}'], 'DATA PERIODS': ['1', '1', 'Data', 'Sunday', ' 1/ 1', '12/31']}\n"
     ]
    }
   ],
   "source": [
    "data=epw()\n",
    "data.read('GRC_Athens.167160_IWEC.epw')\n",
    "head=data.headers # this is a dictionary of the header information\n",
    "print(head)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Year', 'Month', 'Day', 'Hour', 'Minute',\n",
       "       'Data Source and Uncertainty Flags', 'Dry Bulb Temperature',\n",
       "       'Dew Point Temperature', 'Relative Humidity',\n",
       "       'Atmospheric Station Pressure', 'Extraterrestrial Horizontal Radiation',\n",
       "       'Extraterrestrial Direct Normal Radiation',\n",
       "       'Horizontal Infrared Radiation Intensity',\n",
       "       'Global Horizontal Radiation', 'Direct Normal Radiation',\n",
       "       'Diffuse Horizontal Radiation', 'Global Horizontal Illuminance',\n",
       "       'Direct Normal Illuminance', 'Diffuse Horizontal Illuminance',\n",
       "       'Zenith Luminance', 'Wind Direction', 'Wind Speed', 'Total Sky Cover',\n",
       "       'Opaque Sky Cover (used if Horizontal IR Intensity missing)',\n",
       "       'Visibility', 'Ceiling Height', 'Present Weather Observation',\n",
       "       'Present Weather Codes', 'Precipitable Water', 'Aerosol Optical Depth',\n",
       "       'Snow Depth', 'Days Since Last Snowfall', 'Albedo',\n",
       "       'Liquid Precipitation Depth', 'Liquid Precipitation Quantity'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw=data.dataframe.copy()  # this is pandas dataframe\n",
    "df_epw.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       1415\n",
       "1       1415\n",
       "2       1415\n",
       "3       1415\n",
       "4       1415\n",
       "        ... \n",
       "8755    1415\n",
       "8756    1415\n",
       "8757    1415\n",
       "8758    1415\n",
       "8759    1415\n",
       "Name: Extraterrestrial Direct Normal Radiation, Length: 8760, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Extraterrestrial Direct Normal Radiation']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Temperature_C', 'Dew_Point_C', 'Humidity', 'Wind', 'Speed_m/s',\n",
       "       'Gust_m/s', 'Pressure_Pa', 'Precip_Rate_mm', 'G(i)', 'Gb(i)', 'Gd(i)',\n",
       "       'Gr(i)'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([6.25838176, 4.24675905, 4.91729996, ..., 5.36432722, 3.79973178,\n",
       "       3.57621815])"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Speed_m/s'].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour</th>\n",
       "      <th>Minute</th>\n",
       "      <th>Data Source and Uncertainty Flags</th>\n",
       "      <th>Dry Bulb Temperature</th>\n",
       "      <th>Dew Point Temperature</th>\n",
       "      <th>Relative Humidity</th>\n",
       "      <th>Atmospheric Station Pressure</th>\n",
       "      <th>...</th>\n",
       "      <th>Ceiling Height</th>\n",
       "      <th>Present Weather Observation</th>\n",
       "      <th>Present Weather Codes</th>\n",
       "      <th>Precipitable Water</th>\n",
       "      <th>Aerosol Optical Depth</th>\n",
       "      <th>Snow Depth</th>\n",
       "      <th>Days Since Last Snowfall</th>\n",
       "      <th>Albedo</th>\n",
       "      <th>Liquid Precipitation Depth</th>\n",
       "      <th>Liquid Precipitation Quantity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>4.0</td>\n",
       "      <td>69</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>...</td>\n",
       "      <td>77777</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.9</td>\n",
       "      <td>65</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>2.2</td>\n",
       "      <td>62</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>1.9</td>\n",
       "      <td>61</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.8</td>\n",
       "      <td>61</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.3</td>\n",
       "      <td>76</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>21</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.4</td>\n",
       "      <td>78</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>7.1</td>\n",
       "      <td>78</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>23</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>6.4</td>\n",
       "      <td>77</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>5.3</td>\n",
       "      <td>73</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Year  Month  Day  Hour  Minute  \\\n",
       "0     1999      1    1     1      60   \n",
       "1     1999      1    1     2      60   \n",
       "2     1999      1    1     3      60   \n",
       "3     1999      1    1     4      60   \n",
       "4     1999      1    1     5      60   \n",
       "...    ...    ...  ...   ...     ...   \n",
       "8755  1987     12   31    20      60   \n",
       "8756  1987     12   31    21      60   \n",
       "8757  1987     12   31    22      60   \n",
       "8758  1987     12   31    23      60   \n",
       "8759  1987     12   31    24      60   \n",
       "\n",
       "                 Data Source and Uncertainty Flags  Dry Bulb Temperature  \\\n",
       "0     C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0              0.555556   \n",
       "1     C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              0.000000   \n",
       "2     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "3     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "4     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.000000   \n",
       "...                                            ...                   ...   \n",
       "8755  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              4.444444   \n",
       "8756  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              4.444444   \n",
       "8757  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "8758  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              3.888889   \n",
       "8759  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "\n",
       "      Dew Point Temperature  Relative Humidity  Atmospheric Station Pressure  \\\n",
       "0                       4.0                 69                     101749.30   \n",
       "1                       2.9                 65                     101698.51   \n",
       "2                       2.2                 62                     101647.72   \n",
       "3                       1.9                 61                     101647.72   \n",
       "4                       1.8                 61                     101647.72   \n",
       "...                     ...                ...                           ...   \n",
       "8755                    7.3                 76                     101444.56   \n",
       "8756                    7.4                 78                     101444.56   \n",
       "8757                    7.1                 78                     101393.77   \n",
       "8758                    6.4                 77                     101342.98   \n",
       "8759                    5.3                 73                     101342.98   \n",
       "\n",
       "      ...  Ceiling Height  Present Weather Observation  Present Weather Codes  \\\n",
       "0     ...           77777                            9              999999999   \n",
       "1     ...            1350                            9              999999999   \n",
       "2     ...            1350                            9              999999999   \n",
       "3     ...            1350                            9              999999999   \n",
       "4     ...            1350                            9              999999999   \n",
       "...   ...             ...                          ...                    ...   \n",
       "8755  ...           22000                            9              999999999   \n",
       "8756  ...           22000                            9              999999999   \n",
       "8757  ...           22000                            9              999999999   \n",
       "8758  ...           22000                            9              999999999   \n",
       "8759  ...           22000                            9              999999999   \n",
       "\n",
       "      Precipitable Water  Aerosol Optical Depth  Snow Depth  \\\n",
       "0                      0                  0.044           0   \n",
       "1                      0                  0.044           0   \n",
       "2                      0                  0.044           0   \n",
       "3                      0                  0.044           0   \n",
       "4                      0                  0.044           0   \n",
       "...                  ...                    ...         ...   \n",
       "8755                   0                  0.045           0   \n",
       "8756                   0                  0.045           0   \n",
       "8757                   0                  0.045           0   \n",
       "8758                   0                  0.045           0   \n",
       "8759                   0                  0.045           0   \n",
       "\n",
       "      Days Since Last Snowfall  Albedo  Liquid Precipitation Depth  \\\n",
       "0                           88     0.0                         0.0   \n",
       "1                           88     0.0                         0.0   \n",
       "2                           88     0.0                         0.0   \n",
       "3                           88     0.0                         0.0   \n",
       "4                           88     0.0                         0.0   \n",
       "...                        ...     ...                         ...   \n",
       "8755                        88     0.0                         0.0   \n",
       "8756                        88     0.0                         0.0   \n",
       "8757                        88     0.0                         0.0   \n",
       "8758                        88     0.0                         0.0   \n",
       "8759                        88     0.0                         0.0   \n",
       "\n",
       "      Liquid Precipitation Quantity  \n",
       "0                               0.0  \n",
       "1                               0.0  \n",
       "2                               0.0  \n",
       "3                               0.0  \n",
       "4                               0.0  \n",
       "...                             ...  \n",
       "8755                            0.0  \n",
       "8756                            0.0  \n",
       "8757                            0.0  \n",
       "8758                            0.0  \n",
       "8759                            0.0  \n",
       "\n",
       "[8760 rows x 35 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Dry Bulb Temperature']=df.Temperature_C.values\n",
    "df_epw"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour</th>\n",
       "      <th>Minute</th>\n",
       "      <th>Data Source and Uncertainty Flags</th>\n",
       "      <th>Dry Bulb Temperature</th>\n",
       "      <th>Dew Point Temperature</th>\n",
       "      <th>Relative Humidity</th>\n",
       "      <th>Atmospheric Station Pressure</th>\n",
       "      <th>...</th>\n",
       "      <th>Ceiling Height</th>\n",
       "      <th>Present Weather Observation</th>\n",
       "      <th>Present Weather Codes</th>\n",
       "      <th>Precipitable Water</th>\n",
       "      <th>Aerosol Optical Depth</th>\n",
       "      <th>Snow Depth</th>\n",
       "      <th>Days Since Last Snowfall</th>\n",
       "      <th>Albedo</th>\n",
       "      <th>Liquid Precipitation Depth</th>\n",
       "      <th>Liquid Precipitation Quantity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>4.0</td>\n",
       "      <td>69</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>...</td>\n",
       "      <td>77777</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.9</td>\n",
       "      <td>65</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>2.2</td>\n",
       "      <td>62</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>1.9</td>\n",
       "      <td>61</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.8</td>\n",
       "      <td>61</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.3</td>\n",
       "      <td>76</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>21</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.4</td>\n",
       "      <td>78</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>7.1</td>\n",
       "      <td>78</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>23</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>6.4</td>\n",
       "      <td>77</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>5.3</td>\n",
       "      <td>73</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Year  Month  Day  Hour  Minute  \\\n",
       "0     1999      1    1     1      60   \n",
       "1     1999      1    1     2      60   \n",
       "2     1999      1    1     3      60   \n",
       "3     1999      1    1     4      60   \n",
       "4     1999      1    1     5      60   \n",
       "...    ...    ...  ...   ...     ...   \n",
       "8755  1987     12   31    20      60   \n",
       "8756  1987     12   31    21      60   \n",
       "8757  1987     12   31    22      60   \n",
       "8758  1987     12   31    23      60   \n",
       "8759  1987     12   31    24      60   \n",
       "\n",
       "                 Data Source and Uncertainty Flags  Dry Bulb Temperature  \\\n",
       "0     C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0              0.555556   \n",
       "1     C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              0.000000   \n",
       "2     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "3     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "4     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.000000   \n",
       "...                                            ...                   ...   \n",
       "8755  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              4.444444   \n",
       "8756  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              4.444444   \n",
       "8757  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "8758  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              3.888889   \n",
       "8759  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "\n",
       "      Dew Point Temperature  Relative Humidity  Atmospheric Station Pressure  \\\n",
       "0                       4.0                 69                     101749.30   \n",
       "1                       2.9                 65                     101698.51   \n",
       "2                       2.2                 62                     101647.72   \n",
       "3                       1.9                 61                     101647.72   \n",
       "4                       1.8                 61                     101647.72   \n",
       "...                     ...                ...                           ...   \n",
       "8755                    7.3                 76                     101444.56   \n",
       "8756                    7.4                 78                     101444.56   \n",
       "8757                    7.1                 78                     101393.77   \n",
       "8758                    6.4                 77                     101342.98   \n",
       "8759                    5.3                 73                     101342.98   \n",
       "\n",
       "      ...  Ceiling Height  Present Weather Observation  Present Weather Codes  \\\n",
       "0     ...           77777                            9              999999999   \n",
       "1     ...            1350                            9              999999999   \n",
       "2     ...            1350                            9              999999999   \n",
       "3     ...            1350                            9              999999999   \n",
       "4     ...            1350                            9              999999999   \n",
       "...   ...             ...                          ...                    ...   \n",
       "8755  ...           22000                            9              999999999   \n",
       "8756  ...           22000                            9              999999999   \n",
       "8757  ...           22000                            9              999999999   \n",
       "8758  ...           22000                            9              999999999   \n",
       "8759  ...           22000                            9              999999999   \n",
       "\n",
       "      Precipitable Water  Aerosol Optical Depth  Snow Depth  \\\n",
       "0                      0                  0.044           0   \n",
       "1                      0                  0.044           0   \n",
       "2                      0                  0.044           0   \n",
       "3                      0                  0.044           0   \n",
       "4                      0                  0.044           0   \n",
       "...                  ...                    ...         ...   \n",
       "8755                   0                  0.045           0   \n",
       "8756                   0                  0.045           0   \n",
       "8757                   0                  0.045           0   \n",
       "8758                   0                  0.045           0   \n",
       "8759                   0                  0.045           0   \n",
       "\n",
       "      Days Since Last Snowfall  Albedo  Liquid Precipitation Depth  \\\n",
       "0                           88     0.0                         0.0   \n",
       "1                           88     0.0                         0.0   \n",
       "2                           88     0.0                         0.0   \n",
       "3                           88     0.0                         0.0   \n",
       "4                           88     0.0                         0.0   \n",
       "...                        ...     ...                         ...   \n",
       "8755                        88     0.0                         0.0   \n",
       "8756                        88     0.0                         0.0   \n",
       "8757                        88     0.0                         0.0   \n",
       "8758                        88     0.0                         0.0   \n",
       "8759                        88     0.0                         0.0   \n",
       "\n",
       "      Liquid Precipitation Quantity  \n",
       "0                               0.0  \n",
       "1                               0.0  \n",
       "2                               0.0  \n",
       "3                               0.0  \n",
       "4                               0.0  \n",
       "...                             ...  \n",
       "8755                            0.0  \n",
       "8756                            0.0  \n",
       "8757                            0.0  \n",
       "8758                            0.0  \n",
       "8759                            0.0  \n",
       "\n",
       "[8760 rows x 35 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Atmospheric Station Pressure']=df.Pressure_Pa.values\n",
    "df_epw"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour</th>\n",
       "      <th>Minute</th>\n",
       "      <th>Data Source and Uncertainty Flags</th>\n",
       "      <th>Dry Bulb Temperature</th>\n",
       "      <th>Dew Point Temperature</th>\n",
       "      <th>Relative Humidity</th>\n",
       "      <th>Atmospheric Station Pressure</th>\n",
       "      <th>...</th>\n",
       "      <th>Ceiling Height</th>\n",
       "      <th>Present Weather Observation</th>\n",
       "      <th>Present Weather Codes</th>\n",
       "      <th>Precipitable Water</th>\n",
       "      <th>Aerosol Optical Depth</th>\n",
       "      <th>Snow Depth</th>\n",
       "      <th>Days Since Last Snowfall</th>\n",
       "      <th>Albedo</th>\n",
       "      <th>Liquid Precipitation Depth</th>\n",
       "      <th>Liquid Precipitation Quantity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>4.0</td>\n",
       "      <td>77.5</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>...</td>\n",
       "      <td>77777</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.9</td>\n",
       "      <td>83.5</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>2.2</td>\n",
       "      <td>81.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>1.9</td>\n",
       "      <td>77.5</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.8</td>\n",
       "      <td>80.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.3</td>\n",
       "      <td>59.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>21</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.4</td>\n",
       "      <td>59.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>7.1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>23</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>6.4</td>\n",
       "      <td>63.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>5.3</td>\n",
       "      <td>65.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Year  Month  Day  Hour  Minute  \\\n",
       "0     1999      1    1     1      60   \n",
       "1     1999      1    1     2      60   \n",
       "2     1999      1    1     3      60   \n",
       "3     1999      1    1     4      60   \n",
       "4     1999      1    1     5      60   \n",
       "...    ...    ...  ...   ...     ...   \n",
       "8755  1987     12   31    20      60   \n",
       "8756  1987     12   31    21      60   \n",
       "8757  1987     12   31    22      60   \n",
       "8758  1987     12   31    23      60   \n",
       "8759  1987     12   31    24      60   \n",
       "\n",
       "                 Data Source and Uncertainty Flags  Dry Bulb Temperature  \\\n",
       "0     C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0              0.555556   \n",
       "1     C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              0.000000   \n",
       "2     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "3     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "4     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.000000   \n",
       "...                                            ...                   ...   \n",
       "8755  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              4.444444   \n",
       "8756  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              4.444444   \n",
       "8757  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "8758  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              3.888889   \n",
       "8759  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "\n",
       "      Dew Point Temperature  Relative Humidity  Atmospheric Station Pressure  \\\n",
       "0                       4.0               77.5                     101749.30   \n",
       "1                       2.9               83.5                     101698.51   \n",
       "2                       2.2               81.0                     101647.72   \n",
       "3                       1.9               77.5                     101647.72   \n",
       "4                       1.8               80.0                     101647.72   \n",
       "...                     ...                ...                           ...   \n",
       "8755                    7.3               59.0                     101444.56   \n",
       "8756                    7.4               59.0                     101444.56   \n",
       "8757                    7.1               61.0                     101393.77   \n",
       "8758                    6.4               63.0                     101342.98   \n",
       "8759                    5.3               65.0                     101342.98   \n",
       "\n",
       "      ...  Ceiling Height  Present Weather Observation  Present Weather Codes  \\\n",
       "0     ...           77777                            9              999999999   \n",
       "1     ...            1350                            9              999999999   \n",
       "2     ...            1350                            9              999999999   \n",
       "3     ...            1350                            9              999999999   \n",
       "4     ...            1350                            9              999999999   \n",
       "...   ...             ...                          ...                    ...   \n",
       "8755  ...           22000                            9              999999999   \n",
       "8756  ...           22000                            9              999999999   \n",
       "8757  ...           22000                            9              999999999   \n",
       "8758  ...           22000                            9              999999999   \n",
       "8759  ...           22000                            9              999999999   \n",
       "\n",
       "      Precipitable Water  Aerosol Optical Depth  Snow Depth  \\\n",
       "0                      0                  0.044           0   \n",
       "1                      0                  0.044           0   \n",
       "2                      0                  0.044           0   \n",
       "3                      0                  0.044           0   \n",
       "4                      0                  0.044           0   \n",
       "...                  ...                    ...         ...   \n",
       "8755                   0                  0.045           0   \n",
       "8756                   0                  0.045           0   \n",
       "8757                   0                  0.045           0   \n",
       "8758                   0                  0.045           0   \n",
       "8759                   0                  0.045           0   \n",
       "\n",
       "      Days Since Last Snowfall  Albedo  Liquid Precipitation Depth  \\\n",
       "0                           88     0.0                         0.0   \n",
       "1                           88     0.0                         0.0   \n",
       "2                           88     0.0                         0.0   \n",
       "3                           88     0.0                         0.0   \n",
       "4                           88     0.0                         0.0   \n",
       "...                        ...     ...                         ...   \n",
       "8755                        88     0.0                         0.0   \n",
       "8756                        88     0.0                         0.0   \n",
       "8757                        88     0.0                         0.0   \n",
       "8758                        88     0.0                         0.0   \n",
       "8759                        88     0.0                         0.0   \n",
       "\n",
       "      Liquid Precipitation Quantity  \n",
       "0                               0.0  \n",
       "1                               0.0  \n",
       "2                               0.0  \n",
       "3                               0.0  \n",
       "4                               0.0  \n",
       "...                             ...  \n",
       "8755                            0.0  \n",
       "8756                            0.0  \n",
       "8757                            0.0  \n",
       "8758                            0.0  \n",
       "8759                            0.0  \n",
       "\n",
       "[8760 rows x 35 columns]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Relative Humidity']=df.Humidity.values\n",
    "\n",
    "df_epw"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8750    66.0\n",
       "8751     0.0\n",
       "8752     0.0\n",
       "8753     0.0\n",
       "8754     0.0\n",
       "8755     0.0\n",
       "8756     0.0\n",
       "8757     0.0\n",
       "8758     0.0\n",
       "8759     0.0\n",
       "Name: Global Horizontal Radiation, dtype: float64"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Global Horizontal Radiation']=rad.ghi.values\n",
    "\n",
    "df_epw['Global Horizontal Radiation'][-10:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8750    44.075276\n",
       "8751     0.000000\n",
       "8752     0.000000\n",
       "8753     0.000000\n",
       "8754     0.000000\n",
       "8755     0.000000\n",
       "8756     0.000000\n",
       "8757     0.000000\n",
       "8758     0.000000\n",
       "8759     0.000000\n",
       "Name: Direct Normal Radiation, dtype: float64"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Direct Normal Radiation']=rad.dni.values\n",
    "\n",
    "df_epw['Direct Normal Radiation'][-10:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8750    57.416527\n",
       "8751     0.000000\n",
       "8752     0.000000\n",
       "8753     0.000000\n",
       "8754     0.000000\n",
       "8755     0.000000\n",
       "8756     0.000000\n",
       "8757     0.000000\n",
       "8758     0.000000\n",
       "8759     0.000000\n",
       "Name: Diffuse Horizontal Radiation, dtype: float64"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Diffuse Horizontal Radiation']=rad.dhi.values\n",
    "df_epw['Diffuse Horizontal Radiation'][-10:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        22.50\n",
       "1       180.00\n",
       "2         0.00\n",
       "3       168.75\n",
       "4         0.00\n",
       "         ...  \n",
       "8755    157.50\n",
       "8756    168.75\n",
       "8757    326.25\n",
       "8758    326.25\n",
       "8759    168.75\n",
       "Name: Wind Direction, Length: 8760, dtype: float64"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "'''\n",
    "I don't know if the epw file works if we include these\n",
    "'''\n",
    "#df_epw['G(i)']=df['G(i)'].values\n",
    "#df_epw['Gb(i)']=df['Gb(i)'].values\n",
    "#df_epw['Gd(i)']=df['Gd(i)'].values\n",
    "#df_epw['Gr(i)']=df['Gr(i)'].values\n",
    "\n",
    "df_epw['Wind Direction']=df['Wind'].values\n",
    "df_epw['Wind Direction']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       6.258382\n",
       "1       4.246759\n",
       "2       4.917300\n",
       "3       4.917300\n",
       "4       4.917300\n",
       "          ...   \n",
       "8755    3.352705\n",
       "8756    4.246759\n",
       "8757    5.364327\n",
       "8758    3.799732\n",
       "8759    3.576218\n",
       "Name: Wind Speed, Length: 8760, dtype: float64"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_epw['Wind Speed']=df['Speed_m/s'].values\n",
    "\n",
    "df_epw['Wind Speed']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour</th>\n",
       "      <th>Minute</th>\n",
       "      <th>Data Source and Uncertainty Flags</th>\n",
       "      <th>Dry Bulb Temperature</th>\n",
       "      <th>Dew Point Temperature</th>\n",
       "      <th>Relative Humidity</th>\n",
       "      <th>Atmospheric Station Pressure</th>\n",
       "      <th>...</th>\n",
       "      <th>Ceiling Height</th>\n",
       "      <th>Present Weather Observation</th>\n",
       "      <th>Present Weather Codes</th>\n",
       "      <th>Precipitable Water</th>\n",
       "      <th>Aerosol Optical Depth</th>\n",
       "      <th>Snow Depth</th>\n",
       "      <th>Days Since Last Snowfall</th>\n",
       "      <th>Albedo</th>\n",
       "      <th>Liquid Precipitation Depth</th>\n",
       "      <th>Liquid Precipitation Quantity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0</td>\n",
       "      <td>9.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>69</td>\n",
       "      <td>102400</td>\n",
       "      <td>...</td>\n",
       "      <td>77777</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>9.2</td>\n",
       "      <td>2.9</td>\n",
       "      <td>65</td>\n",
       "      <td>102600</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.2</td>\n",
       "      <td>62</td>\n",
       "      <td>102700</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>8.9</td>\n",
       "      <td>1.9</td>\n",
       "      <td>61</td>\n",
       "      <td>102800</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1.8</td>\n",
       "      <td>61</td>\n",
       "      <td>102800</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>11.5</td>\n",
       "      <td>7.3</td>\n",
       "      <td>76</td>\n",
       "      <td>101600</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>21</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>11.1</td>\n",
       "      <td>7.4</td>\n",
       "      <td>78</td>\n",
       "      <td>101600</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>10.7</td>\n",
       "      <td>7.1</td>\n",
       "      <td>78</td>\n",
       "      <td>101700</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>23</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>10.3</td>\n",
       "      <td>6.4</td>\n",
       "      <td>77</td>\n",
       "      <td>101900</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>9.8</td>\n",
       "      <td>5.3</td>\n",
       "      <td>73</td>\n",
       "      <td>102100</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Year  Month  Day  Hour  Minute  \\\n",
       "0     1999      1    1     1      60   \n",
       "1     1999      1    1     2      60   \n",
       "2     1999      1    1     3      60   \n",
       "3     1999      1    1     4      60   \n",
       "4     1999      1    1     5      60   \n",
       "...    ...    ...  ...   ...     ...   \n",
       "8755  1987     12   31    20      60   \n",
       "8756  1987     12   31    21      60   \n",
       "8757  1987     12   31    22      60   \n",
       "8758  1987     12   31    23      60   \n",
       "8759  1987     12   31    24      60   \n",
       "\n",
       "                 Data Source and Uncertainty Flags  Dry Bulb Temperature  \\\n",
       "0     C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0                   9.5   \n",
       "1     C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0                   9.2   \n",
       "2     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0                   9.0   \n",
       "3     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0                   8.9   \n",
       "4     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0                   8.8   \n",
       "...                                            ...                   ...   \n",
       "8755  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0                  11.5   \n",
       "8756  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0                  11.1   \n",
       "8757  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0                  10.7   \n",
       "8758  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0                  10.3   \n",
       "8759  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0                   9.8   \n",
       "\n",
       "      Dew Point Temperature  Relative Humidity  Atmospheric Station Pressure  \\\n",
       "0                       4.0                 69                        102400   \n",
       "1                       2.9                 65                        102600   \n",
       "2                       2.2                 62                        102700   \n",
       "3                       1.9                 61                        102800   \n",
       "4                       1.8                 61                        102800   \n",
       "...                     ...                ...                           ...   \n",
       "8755                    7.3                 76                        101600   \n",
       "8756                    7.4                 78                        101600   \n",
       "8757                    7.1                 78                        101700   \n",
       "8758                    6.4                 77                        101900   \n",
       "8759                    5.3                 73                        102100   \n",
       "\n",
       "      ...  Ceiling Height  Present Weather Observation  Present Weather Codes  \\\n",
       "0     ...           77777                            9              999999999   \n",
       "1     ...            1350                            9              999999999   \n",
       "2     ...            1350                            9              999999999   \n",
       "3     ...            1350                            9              999999999   \n",
       "4     ...            1350                            9              999999999   \n",
       "...   ...             ...                          ...                    ...   \n",
       "8755  ...           22000                            9              999999999   \n",
       "8756  ...           22000                            9              999999999   \n",
       "8757  ...           22000                            9              999999999   \n",
       "8758  ...           22000                            9              999999999   \n",
       "8759  ...           22000                            9              999999999   \n",
       "\n",
       "      Precipitable Water  Aerosol Optical Depth  Snow Depth  \\\n",
       "0                      0                  0.044           0   \n",
       "1                      0                  0.044           0   \n",
       "2                      0                  0.044           0   \n",
       "3                      0                  0.044           0   \n",
       "4                      0                  0.044           0   \n",
       "...                  ...                    ...         ...   \n",
       "8755                   0                  0.045           0   \n",
       "8756                   0                  0.045           0   \n",
       "8757                   0                  0.045           0   \n",
       "8758                   0                  0.045           0   \n",
       "8759                   0                  0.045           0   \n",
       "\n",
       "      Days Since Last Snowfall  Albedo  Liquid Precipitation Depth  \\\n",
       "0                           88     0.0                         0.0   \n",
       "1                           88     0.0                         0.0   \n",
       "2                           88     0.0                         0.0   \n",
       "3                           88     0.0                         0.0   \n",
       "4                           88     0.0                         0.0   \n",
       "...                        ...     ...                         ...   \n",
       "8755                        88     0.0                         0.0   \n",
       "8756                        88     0.0                         0.0   \n",
       "8757                        88     0.0                         0.0   \n",
       "8758                        88     0.0                         0.0   \n",
       "8759                        88     0.0                         0.0   \n",
       "\n",
       "      Liquid Precipitation Quantity  \n",
       "0                               0.0  \n",
       "1                               0.0  \n",
       "2                               0.0  \n",
       "3                               0.0  \n",
       "4                               0.0  \n",
       "...                             ...  \n",
       "8755                            0.0  \n",
       "8756                            0.0  \n",
       "8757                            0.0  \n",
       "8758                            0.0  \n",
       "8759                            0.0  \n",
       "\n",
       "[8760 rows x 35 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['ATHENS', '-', 'GRC', 'IWEC Data', '167160', '37.90', '23.73', '2.0', '15.0']"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.dataframe=df_epw.copy()\n",
    "data.headers['LOCATION']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour</th>\n",
       "      <th>Minute</th>\n",
       "      <th>Data Source and Uncertainty Flags</th>\n",
       "      <th>Dry Bulb Temperature</th>\n",
       "      <th>Dew Point Temperature</th>\n",
       "      <th>Relative Humidity</th>\n",
       "      <th>Atmospheric Station Pressure</th>\n",
       "      <th>...</th>\n",
       "      <th>Ceiling Height</th>\n",
       "      <th>Present Weather Observation</th>\n",
       "      <th>Present Weather Codes</th>\n",
       "      <th>Precipitable Water</th>\n",
       "      <th>Aerosol Optical Depth</th>\n",
       "      <th>Snow Depth</th>\n",
       "      <th>Days Since Last Snowfall</th>\n",
       "      <th>Albedo</th>\n",
       "      <th>Liquid Precipitation Depth</th>\n",
       "      <th>Liquid Precipitation Quantity</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>4.0</td>\n",
       "      <td>77.5</td>\n",
       "      <td>101749.30</td>\n",
       "      <td>...</td>\n",
       "      <td>77777</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.9</td>\n",
       "      <td>83.5</td>\n",
       "      <td>101698.51</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>2.2</td>\n",
       "      <td>81.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.555556</td>\n",
       "      <td>1.9</td>\n",
       "      <td>77.5</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.8</td>\n",
       "      <td>80.0</td>\n",
       "      <td>101647.72</td>\n",
       "      <td>...</td>\n",
       "      <td>1350</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.044</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.3</td>\n",
       "      <td>59.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>21</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>4.444444</td>\n",
       "      <td>7.4</td>\n",
       "      <td>59.0</td>\n",
       "      <td>101444.56</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>7.1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>101393.77</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>23</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>6.4</td>\n",
       "      <td>63.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>1987</td>\n",
       "      <td>12</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>60</td>\n",
       "      <td>C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>5.3</td>\n",
       "      <td>65.0</td>\n",
       "      <td>101342.98</td>\n",
       "      <td>...</td>\n",
       "      <td>22000</td>\n",
       "      <td>9</td>\n",
       "      <td>999999999</td>\n",
       "      <td>0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>0</td>\n",
       "      <td>88</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Year  Month  Day  Hour  Minute  \\\n",
       "0     1999      1    1     1      60   \n",
       "1     1999      1    1     2      60   \n",
       "2     1999      1    1     3      60   \n",
       "3     1999      1    1     4      60   \n",
       "4     1999      1    1     5      60   \n",
       "...    ...    ...  ...   ...     ...   \n",
       "8755  1987     12   31    20      60   \n",
       "8756  1987     12   31    21      60   \n",
       "8757  1987     12   31    22      60   \n",
       "8758  1987     12   31    23      60   \n",
       "8759  1987     12   31    24      60   \n",
       "\n",
       "                 Data Source and Uncertainty Flags  Dry Bulb Temperature  \\\n",
       "0     C9C9C9C9*0?9?9?9?9?9?9?9*0C8C8C8C8*0*0E8*0*0              0.555556   \n",
       "1     C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              0.000000   \n",
       "2     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "3     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.555556   \n",
       "4     C9C9C9C9*0?9?9?9?9?9?9?9*0B8B8B8B8*0*0E8*0*0              0.000000   \n",
       "...                                            ...                   ...   \n",
       "8755  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              4.444444   \n",
       "8756  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              4.444444   \n",
       "8757  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "8758  C9C9C9C9*0?9?9?9?9?9?9?9A7A7A7A7A7A7*0E8*0*0              3.888889   \n",
       "8759  C9C9C9C9*0?9?9?9?9?9?9?9A7A7B8B8A7*0*0E8*0*0              3.888889   \n",
       "\n",
       "      Dew Point Temperature  Relative Humidity  Atmospheric Station Pressure  \\\n",
       "0                       4.0               77.5                     101749.30   \n",
       "1                       2.9               83.5                     101698.51   \n",
       "2                       2.2               81.0                     101647.72   \n",
       "3                       1.9               77.5                     101647.72   \n",
       "4                       1.8               80.0                     101647.72   \n",
       "...                     ...                ...                           ...   \n",
       "8755                    7.3               59.0                     101444.56   \n",
       "8756                    7.4               59.0                     101444.56   \n",
       "8757                    7.1               61.0                     101393.77   \n",
       "8758                    6.4               63.0                     101342.98   \n",
       "8759                    5.3               65.0                     101342.98   \n",
       "\n",
       "      ...  Ceiling Height  Present Weather Observation  Present Weather Codes  \\\n",
       "0     ...           77777                            9              999999999   \n",
       "1     ...            1350                            9              999999999   \n",
       "2     ...            1350                            9              999999999   \n",
       "3     ...            1350                            9              999999999   \n",
       "4     ...            1350                            9              999999999   \n",
       "...   ...             ...                          ...                    ...   \n",
       "8755  ...           22000                            9              999999999   \n",
       "8756  ...           22000                            9              999999999   \n",
       "8757  ...           22000                            9              999999999   \n",
       "8758  ...           22000                            9              999999999   \n",
       "8759  ...           22000                            9              999999999   \n",
       "\n",
       "      Precipitable Water  Aerosol Optical Depth  Snow Depth  \\\n",
       "0                      0                  0.044           0   \n",
       "1                      0                  0.044           0   \n",
       "2                      0                  0.044           0   \n",
       "3                      0                  0.044           0   \n",
       "4                      0                  0.044           0   \n",
       "...                  ...                    ...         ...   \n",
       "8755                   0                  0.045           0   \n",
       "8756                   0                  0.045           0   \n",
       "8757                   0                  0.045           0   \n",
       "8758                   0                  0.045           0   \n",
       "8759                   0                  0.045           0   \n",
       "\n",
       "      Days Since Last Snowfall  Albedo  Liquid Precipitation Depth  \\\n",
       "0                           88     0.0                         0.0   \n",
       "1                           88     0.0                         0.0   \n",
       "2                           88     0.0                         0.0   \n",
       "3                           88     0.0                         0.0   \n",
       "4                           88     0.0                         0.0   \n",
       "...                        ...     ...                         ...   \n",
       "8755                        88     0.0                         0.0   \n",
       "8756                        88     0.0                         0.0   \n",
       "8757                        88     0.0                         0.0   \n",
       "8758                        88     0.0                         0.0   \n",
       "8759                        88     0.0                         0.0   \n",
       "\n",
       "      Liquid Precipitation Quantity  \n",
       "0                               0.0  \n",
       "1                               0.0  \n",
       "2                               0.0  \n",
       "3                               0.0  \n",
       "4                               0.0  \n",
       "...                             ...  \n",
       "8755                            0.0  \n",
       "8756                            0.0  \n",
       "8757                            0.0  \n",
       "8758                            0.0  \n",
       "8759                            0.0  \n",
       "\n",
       "[8760 rows x 35 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.write('Atene2016.epw')\n",
    "data.dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
